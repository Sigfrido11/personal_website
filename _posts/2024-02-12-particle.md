---
layout: post
title: Particle project
tags: [A Tag, Katex]
last_modified: "2025-05-30"
excerpt_separator: <!--more-->
categories: Example
lang: it
translation_en: |
  # Particle Physics Simulation and K\* Reconstruction
  
  ## Overview
  
  This project implements a **Monte Carlo simulation of particle physics events** using ROOT for statistical analysis and visualization.
  
  The main goal is:
  
  >  **Reconstruct the K\*** resonance (mass ~0.892 GeV) from the invariant-mass spectrum of $\pi$–K pairs.
  
  The code simulates events with light particles ($\pi$, K, p) and an unstable resonance (K\*) that decays into two bodies. It then analyzes invariant-mass spectra to identify the resonance peak above the combinatorial background.
  
  ---
  
  #  Project Structure
  
  The project is split into three main components:
  
  ## 1 `particle.cpp`
  
  Implements the `Particle` class, which represents a physical particle with:
  
  - name
  - momentum (px, py, pz)
  - mass
  - charge
  - optional decay width (for resonances)
  
  ### Main features
  
  - Relativistic energy calculation:
  $$ E = \sqrt{p^2 + m^2}$$
  
  
  - Invariant mass calculation between two particles:
  
  $$m_{inv} = \sqrt{(E1 + E2)^2 - |p1 + p2|^2}$$
  
  
  - Two-body decay (`Decay2Body`)
  - Includes resonance width effects (Breit-Wigner simulated via Gaussian distribution)
  - Isotropic generation of decay products
  - Applies relativistic boost to the laboratory frame
  
  This class is the physics core of the project.
  
  ---
  
  ## 2 `main.cpp`
  
  It is the **simulation engine**.
  
  ### What it does
  
  Defines particle types:
  - $\pi$⁺, $\pi$⁻
  - K⁺, K⁻
  - p⁺, p⁻
  - K\* resonance (mass 0.89166 GeV, width 0.050 GeV)
  
  Simulates 100,000 events with 100 particles each.
  
  ---
  
  ## Particle Generation
  
  Particles are generated with the following probabilities:
  
  | Particle | Probability |
  |------------|------------|
  | $\pi$⁺ | 40% |
  | $\pi$⁻ | 40% |
  | K⁺ | 5% |
  | K⁻ | 5% |
  | p⁺ | 4.5% |
  | p⁻ | 4.5% |
  | K\* | 1% |
  
  The magnitude of the momentum follows an isotropic exponential distribution:
  
  $$p \sim e^{-p}$$
  .
  
  ---
  
  ## K\* Production and Decay
  
  When a resonance is generated:
  
  1. A particle `"resonance"` is created
  2. It decays into:
     - $\pi$⁺ K⁻  (50%)
     - $\pi$⁻ K⁺  (50%)
  
  3. The following are recorded:
     - invariant mass of decay products
     - contribution to the combinatorial background
  
  This is essential to verify that the resonance peak can be reconstructed even in the presence of background.
  
  ---
  #  Analysis (`analyse.cpp`)
  
  The analysis phase reads the generated ROOT file and checks the physical and statistical consistency of the simulation.
  
  ---
  
  ## Consistency Checks
  
  - Total number of particles generated  
  - Species distributions ($\pi$, K, p, K\*)  
  - Comparison with theoretical probabilities (compatibility within $3\sigma$)
  
  The goal is to verify that the Monte Carlo generation correctly reproduces the fractions set in the generator.
  
  ---
  
  ## Distribution Studies
  
  Several kinematic observables are analyzed:
  
  - Uniform angle distributions ($\phi$, $\theta$)
  - Exponential fit of the momentum magnitude:
  
  $$ f(p) \propto e^{-p} $$
  
  - Invariant mass spectra built for:
    - all pairs
    - same-charge pairs
    - opposite-charge pairs
    - $\pi$–K pairs only
  
  ---
  
  ## Combinatorial Background Subtraction
  
  To isolate the K\* signal, the difference between opposite-charge and same-charge pairs is used:
  
  $$
  \text{Signal}(m) =
  \left( \frac{dN}{dm} \right)_{\text{opposite charge}}
  -
  \left( \frac{dN}{dm} \right)_{\text{same charge}}
  $$
  
  This method reduces the uncorrelated background, allowing the contribution of real resonances to emerge.
  
  Two spectra are obtained:
  
  - Full spectrum (all combinations)
  - Spectrum selecting only $\pi$–K pairs (physically cleaner)
  
  ---
  
  ## Resonance Fit
  
  The peak is fitted with a Gaussian function:
  
  $$
  f(m) = A \exp\left(
  -\frac{(m - \mu)^2}{2\sigma^2}
  \right)
  $$
  
  The fit extracts:
  
  - K\* mass ($\mu$)
  - Observed width ($\sigma$)
  - $\chi^2/\text{NDF}$
  - Fit probability
  
  The expected result is a mass compatible with:
  
  $$
  m_{K^*} \approx 0.892 \ \text{GeV}
  $$
  
  ---
  
  # Why This Project Is Interesting
  
  This code reproduces, in simplified form, real analysis techniques used in high-energy physics:
  
  - Resonance reconstruction via invariant mass  
  - Combinatorial background estimation and subtraction  
  - Statistical fits with ROOT  
  - Validation through $\chi^2$ and fit probability  
  
  To do this, it goes through all phases, starting from the simulation where particles are generated according to a given distribution and the decay of possible K\* is studied, to the data analysis phase where histograms of possible combinations are built and the background is then removed. This process highlights a peak in the invariant-mass plot, revealing the presence of the resonance.


<hr>

<h2> Collaborators</h2>

<div style="display: flex; gap: 20px; flex-wrap: wrap; align-items: center;">

  <div>
    <strong>Sigfrido11</strong><br>
    <a href="https://github.com/Sigfrido11" target="_blank">Profilo GitHub</a>
  </div>

  <div>
    <strong>Fioralli</strong><br>
    <a href="https://github.com/Fioralli" target="_blank">Profilo GitHub</a>
  </div>

  <div>
    <strong>SierraTangoEcho</strong><br>
    <a href="https://github.com/SierraTangoEcho" target="_blank">Profilo GitHub</a>
  </div>

</div>

<p>
This project was developed through the collaboration of all participants.
</p>


---
# Particle Physics Simulation and K\* Reconstruction

## Overview

Questo progetto implementa una **simulazione Monte Carlo di eventi di fisica delle particelle** utilizzando ROOT per l’analisi statistica e la visualizzazione dei risultati.

L’obiettivo principale è:

>  **Ricostruire la risonanza K\*** (massa ~0.892 GeV) a partire dallo spettro delle masse invarianti delle coppie $\pi$–K.

Il codice simula eventi con produzione di particelle leggere ($\pi$, K, p) e di una risonanza instabile (K\*) che decade in due corpi. Successivamente analizza gli spettri di massa invariante per identificare il picco della risonanza sopra il fondo combinatoriale.

---

#  Struttura del Progetto

Il progetto è diviso in tre componenti principali:

## 1 `particle.cpp`

Implementa la classe `Particle`, che rappresenta una particella fisica con:

- nome
- quantità di moto (px, py, pz)
- massa
- carica
- eventuale larghezza di decadimento (per le risonanze)

### Funzionalità principali

- Calcolo dell’energia relativistica:
$$ E = \sqrt{p^2 + m^2}$$


- Calcolo della massa invariante tra due particelle:

$$m_{inv} = \sqrt{(E1 + E2)^2 - |p1 + p2|^2}$$


- Decadimento a due corpi (`Decay2Body`)
- Include effetto di larghezza della risonanza (Breit-Wigner simulato via distribuzione gaussiana)
- Genera i prodotti in modo isotropico
- Applica boost relativistico nel sistema del laboratorio

Questa classe è il cuore fisico del progetto.

---

## 2 `main.cpp`

È il **motore della simulazione**.

### Cosa fa

Definisce i tipi di particelle:
- $\pi$⁺, $\pi$⁻
- K⁺, K⁻
- p⁺, p⁻
- risonanza K\* (massa 0.89166 GeV, width 0.050 GeV)

Simula 100.000 eventi da 100 particelle

---

## Generazione delle particelle

Le particelle vengono generate con probabilità:

| Particella | Probabilità |
|------------|------------|
| $\pi$⁺ | 40% |
| $\pi$⁻ | 40% |
| K⁺ | 5% |
| K⁻ | 5% |
| p⁺ | 4.5% |
| p⁻ | 4.5% |
| K\* | 1% |

Il modulo della quantità di moto segue una distribuzione isotropa esponenziale:

$$p \sim e^{-p}$$
.

---

## Produzione e decadimento della K\*

Quando viene generata una risonanza:

1. Viene creata una particella `"resonance"`
2. Viene fatta decadere in:
   - $\pi$⁺ K⁻  (50%)
   - $\pi$⁻ K⁺  (50%)

3. Si registra:
   - massa invariante dei prodotti di decadimento
   - contributo al fondo combinatoriale

Questo è fondamentale per verificare che il picco della risonanza sia ricostruibile anche in presenza di fondo.

---
#  Analisi (`analyse.cpp`)

La fase di analisi legge il file ROOT generato e verifica la coerenza fisica e statistica della simulazione.

---

## Controlli di consistenza

- Numero totale di particelle generate  
- Distribuzione delle specie ($\pi$, K, p, K\*)  
- Confronto con le probabilità teoriche (compatibilità entro $3\sigma$)

L’obiettivo è verificare che la generazione Monte Carlo riproduca correttamente le frazioni impostate nel generatore.

---

## Studio delle distribuzioni

Vengono analizzate diverse osservabili cinematiche:

- Distribuzione uniforme degli angoli ($\phi$, $\theta$)
- Fit esponenziale del modulo della quantità di moto:

$$ f(p) \propto e^{-p} $$

- Spettri di massa invariante costruiti per:
  - tutte le coppie
  - coppie a stessa carica
  - coppie a carica opposta
  - sole coppie $\pi$–K

---

## Sottrazione del fondo combinatoriale

Per isolare il segnale della K\* si utilizza la differenza tra coppie a carica opposta e coppie a stessa carica:

$$
\text{Signal}(m) =
\left( \frac{dN}{dm} \right)_{\text{opposite charge}}
-
\left( \frac{dN}{dm} \right)_{\text{same charge}}
$$

Questo metodo riduce il fondo non correlato, lasciando emergere il contributo delle vere risonanze.

Si ottengono due spettri:

- Spettro completo (tutte le combinazioni)
- Spettro selezionando solo coppie $\pi$–K (fisicamente più pulito)

---

##  Fit della risonanza

Il picco viene fittato con una funzione gaussiana:

$$
f(m) = A \exp\left(
-\frac{(m - \mu)^2}{2\sigma^2}
\right)
$$

Dal fit si estraggono:

- Massa della K\* ($\mu$)
- Larghezza osservata ($\sigma$)
- $\chi^2/\text{NDF}$
- Probabilità del fit

Il risultato atteso è una massa compatibile con:

$$
m_{K^*} \approx 0.892 \ \text{GeV}
$$

---

# Perché questo progetto è interessante

Questo codice riproduce in forma semplificata tecniche reali di analisi in fisica delle alte energie:

- Ricostruzione di risonanze tramite massa invariante  
- Stima e sottrazione del fondo combinatoriale  
- Fit statistici con ROOT  
- Validazione tramite $\chi^2$ e probabilità del fit  

Per farlo si passa attraverso tutte le fasi partendo dalla simulazione in cui vengono generate le particelle secondo una data distribuzione e si studia il decadimento delle possibili $k^*$ all'analisi dei dati nella quale si costruiscono gli istogrammi delle possibili combinazioni per poi rimuovere il fondo. Questo processo permette quindi di evidenziare un picco nel grafico della massa invariante evidenziando così la presenza della risonanza.

Lo scopo fisico è dimostrare che una risonanza instabile può essere identificata attraverso le sue particelle di decadimento anche in presenza di un grande fondo statistico.

<hr>

<h2> Collaboratori</h2>

<div style="display: flex; gap: 20px; flex-wrap: wrap; align-items: center;">

  <div>
    <strong>Sigfrido11</strong><br>
    <a href="https://github.com/Sigfrido11" target="_blank">Profilo GitHub</a>
  </div>

  <div>
    <strong>Fioralli</strong><br>
    <a href="https://github.com/Fioralli" target="_blank">Profilo GitHub</a>
  </div>

  <div>
    <strong>SierraTangoEcho</strong><br>
    <a href="https://github.com/SierraTangoEcho" target="_blank">Profilo GitHub</a>
  </div>

</div>

<p>
Questo progetto è stato sviluppato grazie alla collaborazione tra tutti i partecipanti.
</p>

---
